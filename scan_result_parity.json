{"repoPath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper","scanTime":"2026-02-17T21:57:40.330814","totalFiles":1,"totalStatements":14,"totalViolations":33,"errorCount":8,"warningCount":23,"infoCount":2,"violations":[{"rule":{"id":"OG_3_6_3","name":"UPDATE 必须有 WHERE","description":"UPDATE 语句中必须有 WHERE 子句，避免全表更新","severity":"ERROR","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_WHERE","section":"3.6.3","category":"UPDATE","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"updateAll","statementType":"update","sqlText":"UPDATE t_user SET status = 0","lineNumber":44,"namespace":"com.example.mapper.UserMapper"},"message":"UPDATE 语句必须包含 WHERE 子句，防止全表更新","matchedText":"UPDATE t_user SET status = 0"},{"rule":{"id":"OG_3_7_3","name":"DELETE 必须有 WHERE","description":"DELETE 语句中必须有 WHERE 子句，避免全表删除","severity":"ERROR","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_WHERE","section":"3.7.3","category":"DELETE","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"updateAll","statementType":"update","sqlText":"UPDATE t_user SET status = 0","lineNumber":44,"namespace":"com.example.mapper.UserMapper"},"message":"UPDATE 语句必须包含 WHERE 子句，防止全表更新","matchedText":"UPDATE t_user SET status = 0"},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findAll","statementType":"select","sqlText":"SELECT * FROM t_user","lineNumber":13,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_4_1","name":"禁止 SELECT *","description":"SELECT 语句中禁用通配符字段 *，请明确指定查询列","severity":"ERROR","type":"BUILT_IN","pattern":null,"checkerName":"NO_SELECT_STAR","section":"3.4.1","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findAll","statementType":"select","sqlText":"SELECT * FROM t_user","lineNumber":13,"namespace":"com.example.mapper.UserMapper"},"message":"禁止使用 SELECT *，请明确指定需要查询的列","matchedText":"SELECT * FROM"},{"rule":{"id":"OG_3_4_LIMIT","name":"SELECT 建议分页","description":"SELECT 语句建议使用 LIMIT 分页，避免全表查询","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_LIMIT","section":"3.4.6","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findAll","statementType":"select","sqlText":"SELECT * FROM t_user","lineNumber":13,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 查询建议添加 LIMIT 限制，避免大数据量查询影响性能","matchedText":"SELECT * FROM t_user"},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findByStatus","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status = null","lineNumber":18,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_3_1","name":"禁止用 = 或 != 判断 NULL","description":"查询条件中判断 NULL 时，禁止使用 = 和 !=，应使用 IS NULL 或 IS NOT NULL","severity":"ERROR","type":"BUILT_IN","pattern":null,"checkerName":"NULL_COMPARISON","section":"3.3.1","category":"WHERE子句","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findByStatus","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status = null","lineNumber":18,"namespace":"com.example.mapper.UserMapper"},"message":"禁止使用比较操作符判断 NULL，必须使用 IS NULL 或 IS NOT NULL","matchedText":"= null"},{"rule":{"id":"OG_3_4_LIMIT","name":"SELECT 建议分页","description":"SELECT 语句建议使用 LIMIT 分页，避免全表查询","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_LIMIT","section":"3.4.6","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findByStatus","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status = null","lineNumber":18,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 查询建议添加 LIMIT 限制，避免大数据量查询影响性能","matchedText":"SELECT id, username FROM t_user WHERE status = null"},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"searchByName","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE username LIKE '%test%'","lineNumber":24,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_3_5","name":"LIKE 禁止前缀 %","description":"LIKE 语句 % 不应放在首字符位置，会导致全表扫描","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"LIKE_PERCENT_START","section":"3.3.5","category":"WHERE子句","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"searchByName","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE username LIKE '%test%'","lineNumber":24,"namespace":"com.example.mapper.UserMapper"},"message":"LIKE 查询 '%' 在首位将导致全表扫描，无法利用索引","matchedText":"LIKE '%"},{"rule":{"id":"OG_3_4_LIMIT","name":"SELECT 建议分页","description":"SELECT 语句建议使用 LIMIT 分页，避免全表查询","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_LIMIT","section":"3.4.6","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"searchByName","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE username LIKE '%test%'","lineNumber":24,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 查询建议添加 LIMIT 限制，避免大数据量查询影响性能","matchedText":"SELECT id, username FROM t_user WHERE username LIKE '%test%'"},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findAllUsers","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status = 1 UNION SELECT id, username FROM t_user WHERE status = 2","lineNumber":30,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_4_4","name":"优先使用 UNION ALL","description":"考虑使用 UNION ALL 代替 UNION，避免不必要的去重排序开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"UNION_ALL","section":"3.4.4","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findAllUsers","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status = 1 UNION SELECT id, username FROM t_user WHERE status = 2","lineNumber":30,"namespace":"com.example.mapper.UserMapper"},"message":"检测到 UNION，如无需去重请使用 UNION ALL 以提升性能","matchedText":"UNION"},{"rule":{"id":"OG_3_4_LIMIT","name":"SELECT 建议分页","description":"SELECT 语句建议使用 LIMIT 分页，避免全表查询","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_LIMIT","section":"3.4.6","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findAllUsers","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status = 1 UNION SELECT id, username FROM t_user WHERE status = 2","lineNumber":30,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 查询建议添加 LIMIT 限制，避免大数据量查询影响性能","matchedText":"SELECT id, username FROM t_user WHERE status = 1 UNION SELECT id, username FROM ..."},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findUserOrders","statementType":"select","sqlText":"SELECT u.username, o.order_no FROM t_user u, t_order o WHERE u.id = o.user_id","lineNumber":37,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_4_LIMIT","name":"SELECT 建议分页","description":"SELECT 语句建议使用 LIMIT 分页，避免全表查询","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_LIMIT","section":"3.4.6","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findUserOrders","statementType":"select","sqlText":"SELECT u.username, o.order_no FROM t_user u, t_order o WHERE u.id = o.user_id","lineNumber":37,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 查询建议添加 LIMIT 限制，避免大数据量查询影响性能","matchedText":"SELECT u.username, o.order_no FROM t_user u, t_order o WHERE u.id = o.user_id"},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findByCondition","statementType":"select","sqlText":"SELECT id, username, email FROM t_user WHERE ${column} = ?","lineNumber":54,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_4_LIMIT","name":"SELECT 建议分页","description":"SELECT 语句建议使用 LIMIT 分页，避免全表查询","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_LIMIT","section":"3.4.6","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findByCondition","statementType":"select","sqlText":"SELECT id, username, email FROM t_user WHERE ${column} = ?","lineNumber":54,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 查询建议添加 LIMIT 限制，避免大数据量查询影响性能","matchedText":"SELECT id, username, email FROM t_user WHERE ${column} = ?"},{"rule":{"id":"OG_MYBATIS_INJECTION","name":"SQL 注入风险","description":"MyBatis 中使用 ${} 存在 SQL 注入风险，应使用 #{} 参数绑定","severity":"ERROR","type":"BUILT_IN","pattern":null,"checkerName":"SQL_INJECTION_RISK","section":"MyBatis","category":"安全","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findByCondition","statementType":"select","sqlText":"SELECT id, username, email FROM t_user WHERE ${column} = ?","lineNumber":54,"namespace":"com.example.mapper.UserMapper"},"message":"存在 SQL 注入风险：使用了 ${} 字符串拼接，建议使用 #{} 参数绑定","matchedText":"${column}"},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findActiveUsers","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status NOT IN (3, 4, 5)","lineNumber":60,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_3_4","name":"少用负向操作符","description":"查询条件中尽量少使用 !=, <>, NOT IN 等无法利用索引的操作符","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"NOT_EQUAL_OPS","section":"3.3.4","category":"WHERE子句","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findActiveUsers","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status NOT IN (3, 4, 5)","lineNumber":60,"namespace":"com.example.mapper.UserMapper"},"message":"检测到负向操作符 'NOT IN'，可能无法利用索引","matchedText":"NOT IN"},{"rule":{"id":"OG_3_4_LIMIT","name":"SELECT 建议分页","description":"SELECT 语句建议使用 LIMIT 分页，避免全表查询","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_LIMIT","section":"3.4.6","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findActiveUsers","statementType":"select","sqlText":"SELECT id, username FROM t_user WHERE status NOT IN (3, 4, 5)","lineNumber":60,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 查询建议添加 LIMIT 限制，避免大数据量查询影响性能","matchedText":"SELECT id, username FROM t_user WHERE status NOT IN (3, 4, 5)"},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"countUsers","statementType":"select","sqlText":"SELECT count(*) FROM t_user WHERE status = 1","lineNumber":66,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_4_5","name":"慎用 count()","description":"避免频繁使用 count() 获取大表行数，资源消耗较大","severity":"INFO","type":"BUILT_IN","pattern":null,"checkerName":"COUNT_USAGE","section":"3.4.5","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"countUsers","statementType":"select","sqlText":"SELECT count(*) FROM t_user WHERE status = 1","lineNumber":66,"namespace":"com.example.mapper.UserMapper"},"message":"检测到 count() 调用，大表资源消耗大，请评估是否必要","matchedText":"count("},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findWithoutSchema","statementType":"select","sqlText":"SELECT id FROM t_user WHERE id = 1","lineNumber":71,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_4_LIMIT","name":"SELECT 建议分页","description":"SELECT 语句建议使用 LIMIT 分页，避免全表查询","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_LIMIT","section":"3.4.6","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findWithoutSchema","statementType":"select","sqlText":"SELECT id FROM t_user WHERE id = 1","lineNumber":71,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 查询建议添加 LIMIT 限制，避免大数据量查询影响性能","matchedText":"SELECT id FROM t_user WHERE id = 1"},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findWithSubqueryInTarget","statementType":"select","sqlText":"SELECT id, (SELECT count(*) FROM t_order WHERE user_id = u.id) as order_count FROM t_user u","lineNumber":76,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_order' 未指定Schema前缀(如 public.t_order)，可能增加搜索开销","matchedText":"FROM t_order"},{"rule":{"id":"OG_3_4_5","name":"慎用 count()","description":"避免频繁使用 count() 获取大表行数，资源消耗较大","severity":"INFO","type":"BUILT_IN","pattern":null,"checkerName":"COUNT_USAGE","section":"3.4.5","category":"SELECT","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findWithSubqueryInTarget","statementType":"select","sqlText":"SELECT id, (SELECT count(*) FROM t_order WHERE user_id = u.id) as order_count FROM t_user u","lineNumber":76,"namespace":"com.example.mapper.UserMapper"},"message":"检测到 count() 调用，大表资源消耗大，请评估是否必要","matchedText":"count("},{"rule":{"id":"OG_3_9_3","name":"目标列禁用子查询","description":"避免在 SELECT 目标列中使用子查询，可能导致计划无法下推影响执行性能","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SUBQUERY_IN_TARGET","section":"3.9.3","category":"子查询","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findWithSubqueryInTarget","statementType":"select","sqlText":"SELECT id, (SELECT count(*) FROM t_order WHERE user_id = u.id) as order_count FROM t_user u","lineNumber":76,"namespace":"com.example.mapper.UserMapper"},"message":"SELECT 目标列中包含子查询，可能导致无法下推影响执行性能","matchedText":"SELECT ... (subquery) ..."},{"rule":{"id":"OG_3_2_2","name":"建议使用Schema前缀","description":"访问对象（表，函数等）时建议带上SCHEMA名称，避免不必要的性能开销","severity":"WARNING","type":"BUILT_IN","pattern":null,"checkerName":"SCHEMA_PREFIX","section":"3.2.2","category":"对象访问","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"findById","statementType":"select","sqlText":"SELECT id, username, email FROM t_user WHERE id = ? LIMIT 1","lineNumber":82,"namespace":"com.example.mapper.UserMapper"},"message":"表 't_user' 未指定Schema前缀(如 public.t_user)，可能增加搜索开销","matchedText":"FROM t_user"},{"rule":{"id":"OG_3_6_3","name":"UPDATE 必须有 WHERE","description":"UPDATE 语句中必须有 WHERE 子句，避免全表更新","severity":"ERROR","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_WHERE","section":"3.6.3","category":"UPDATE","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"deleteAll","statementType":"delete","sqlText":"DELETE FROM t_user","lineNumber":49,"namespace":"com.example.mapper.UserMapper"},"message":"DELETE 语句必须包含 WHERE 子句，防止全表删除","matchedText":"DELETE FROM t_user"},{"rule":{"id":"OG_3_7_2","name":"全表删除用 TRUNCATE","description":"清空一张表建议使用 TRUNCATE，而不是 DELETE","severity":"ERROR","type":"BUILT_IN","pattern":null,"checkerName":"DELETE_TRUNCATE","section":"3.7.2","category":"DELETE","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"deleteAll","statementType":"delete","sqlText":"DELETE FROM t_user","lineNumber":49,"namespace":"com.example.mapper.UserMapper"},"message":"全表删除建议使用 TRUNCATE TABLE 代替 DELETE","matchedText":"DELETE without WHERE"},{"rule":{"id":"OG_3_7_3","name":"DELETE 必须有 WHERE","description":"DELETE 语句中必须有 WHERE 子句，避免全表删除","severity":"ERROR","type":"BUILT_IN","pattern":null,"checkerName":"REQUIRE_WHERE","section":"3.7.3","category":"DELETE","source":"DEFAULT"},"sqlFragment":{"filePath":"/Users/benjaminpeng/AI/sql-audit/backend/src/test/resources/test-mapper/UserMapper.xml","relativePath":"UserMapper.xml","statementId":"deleteAll","statementType":"delete","sqlText":"DELETE FROM t_user","lineNumber":49,"namespace":"com.example.mapper.UserMapper"},"message":"DELETE 语句必须包含 WHERE 子句，防止全表删除","matchedText":"DELETE FROM t_user"}],"scannedFiles":["UserMapper.xml"]}